---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by yujing.
--- DateTime: 2020/4/7 1:38 下午
---
require("ecc")
require("bit")
local pub = {}
local priv = {}
local signature = {}
local a,b = ecc_make_key(pub,priv)
--print(string.lower(a))
--print(string.lower(b))
local hash = {}
for i = 1 ,32 do
    priv[i]= 49
end
for i = 1 ,8 do
    hash[(i-1)*4+1]= 116
    hash[(i-1)*4+2]= 101
    hash[(i-1)*4+3]= 115
    hash[(i-1)*4+4]= 116
end
--for i = 1 ,32 do
--    hash[i]= 49
--end
--priv = ecc_hex2native("6930f46dd0b16d866d59d1054aa63298b357499cd1862ef16f3f55f1cafceb82f8fcdfbfe88d36edf9cd2d3c99c8d451b3b4a14091da40d00e9333c3d37fe6ab")
ecdsa_sign(priv,hash,signature)
local sigstr = ""

for i = 1,64 do
    sigstr = sigstr ..string.format("%x",signature[i]/16)
    sigstr = sigstr ..string.format("%x",signature[i]%16)
end
print("signature ",string.lower(sigstr))
--ecc_hex2native()
--local sig = "6930f46dd0b16d866d59d1054aa63298b357499cd1862ef16f3f55f1cafceb8259ce0991829ce0b4923597caf21eb573543de8386e8c99787312523ae0b93fde"
--for i = 1,64 do
--    signature[i] = sig[i]
--end
print(ecdsa_verify(a,hash,signature))
--local aa = {0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff}
--local bb = {0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff,0xffff}

--vli_mult(pub,aa,bb)
--for i = 1, 32 do
--    print(pub[i])
--end
--vli_modInv(priv,pub,Curve_P)
--for i = 1,16 do
--    print(priv[i])
--end
--bb = {0xd458,0x5f00,0xc671,0x43cf,0xcc25,0xaf6d,0x908a,0xfb09,0xcd7a,0xfd9b,0x7f9d,0x7024,0xa718,0x491b,0xd42c,0x1306}
--cc = {0xbf0a,0x9ef9,0x8f21,0xe740,0x0232,0x0040,0x1ec7,0x2683,0x8b94,0x97b4,0x04f8,0xb80a,0xd733,0x82b8,0x28fa,0x7f65}
--local cc = {0x7f65,0x28fa,0x82b8,0xd733,0xb80a,0x04f8,0x97b4,0x8b94,0x2683,0x1ec7,0x0040,0x0232,0xe740,0x8f21,0x9ef9,0xbf0a}
--local bb = {0x1306,0xd42c,0x491b,0xa718,0x7024,0x7f9d,0xfd9b,0xcd7a,0xfb09,0x908a,0xaf6d,0xcc25,0x43cf,0xc671,0x5f00,0xd458}
--vli_modMult_fast(pub,bb,cc)
--for i = 1,16 do
--    print(string.format("%x",pub[i]))
--end
--vli_lshift(pub,aa,2)
--print(table.concat(aa))
--local str =""
--print(#pub)
--for i = 2,65 do
--    str = str ..string.format("%02X",pub[i])
--end
--print(str)
--print(table.concat(pub))
--
--0000101000111000
--1110000010001011
--1010100000010111
--0101101010000000
--str = ("39,990,404,219,316,589,175,266,945,007,892,510,767"):gsub(",","")
--str1 = ("35,352,207,715,162,692,984,816,529,456,531,441"):gsub(",","")
--str2 = ("39,990,404,219,316,589,162,926,865,237,788,140,065"):gsub(",","")
--str3 = ("40,025,756,427,031,751,868,251,761,537,349,042,208"):gsub(",","")
--str4 = ("80,016,160,646,348,341,031,178,626,775,137,182,273"):gsub(",","")
--print(str)
--print(str1)
--print(str2)
--print(str3)
--print(str4)
--0011110000110010100011010100111010110111011100111110001100111000
--0011110000110010100011010100111010110111011100111110001100111000 --4337684760335999800
--0000100001100011011110010010111000100011101010001110001001000001
--0000100001100011011110010010111000100011101010001110001001000001 --604460014071505473

--0000101000111000111000001000101110101000000101110101101010010100
--736585429500254868

--right 0111100110111110011001100111111011111001110111001011101110101100010101011010000001100010100101011100111010000111000010110000011100000010100110111111110011011011001011011100111000101000110110010101100111110010100000010101101100010110111110000001011110010111
--left 0111100110111110011001100111111011111001110111001011101110101100010101011010000001100010100101011100111010000111000010110000011100000010100110111111110011011011001011011100111000101000110110010101100111110010100000010101101100010110111110000001011110011001
--111001111001011000101010000000010101011011011011111011001001100100101101110101111011001000110001100100011001010000100101111000010000100000010010101100000101011010100011000010010011100000010110111010101111001001011100101001101010111001101100000101010111000011101010010100010110001110010011001110001100101000100101010110000010100011100011100000100010111010100000010111010110101001010001000110110011100001010011100110000010000010010001011010101100111010100110010111100010101000101111011000101011001010101000111111
